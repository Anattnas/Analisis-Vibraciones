<!DOCTYPE html> <!-- Define el tipo de documento como HTML5 -->
<html lang="es"> <!-- Lenguaje principal de la página: español -->

<head> <!-- Inicio del head: metadatos y enlaces a CSS/JS -->
    <meta charset="UTF-8"> <!-- Codificación de caracteres UTF-8 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Hace la página responsive -->
    <title>Análisis de Vibraciones</title> <!-- Título de la pestaña del navegador -->

    <!-- Bootstrap CSS desde CDN (proporciona estilos y componentes como dropdowns) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Enlace a tu archivo de estilos personalizados en /static/css/estilos.css -->
    <!-- Usamos url_for de Flask para formar la ruta correcta a archivos estáticos -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/estilos.css') }}">
</head> <!-- Fin del head -->

<body class="bg-light"> <!-- Inicio del body, con fondo claro -->

    <div class="container py-5"> <!-- Contenedor principal con padding vertical -->
        <h1 class="text-center mb-4">Análisis de Vibraciones</h1> <!-- Título centrado -->

        <p class="text-center text-muted">Proyecto Flask con Bootstrap</p> <!-- Subtítulo -->

        <!-- FILA que contendrá el dropdown y un breve control -->
        <div class="row mb-4"> <!-- Row de Bootstrap con margen inferior -->
            <div class="col-12 d-flex justify-content-center"> <!-- Columna centrada -->
                <!-- Dropdown: envolvemos toggle y menu dentro de .dropdown -->
                <div class="dropdown"> <!-- Contenedor del dropdown (posicionamiento relativo) -->
                    <!-- Botón que actúa como toggle del dropdown -->
                    <button id="estadoDropdownBtn" class="btn btn-primary dropdown-toggle" type="button"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        Seleccionar estado <!-- Texto que muestra el estado por defecto -->
                    </button>

                    <!-- Lista del menú del dropdown -->
                    <ul id="estadoDropdownMenu" class="dropdown-menu"> <!-- Menú desplegable -->
                        <li>
                            <!-- Cada <a> es un item; usamos data-attribute para identificar el estado -->
                            <a class="dropdown-item" href="#" data-estado="reposo">Reposo</a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="#" data-estado="normal">Normal</a>
                        </li>
                        <li>
                            <a class="dropdown-item" href="#" data-estado="falla">Falla</a>
                        </li>
                    </ul>
                </div> <!-- fin .dropdown -->
            </div> <!-- fin columna -->
        </div> <!-- fin row -->

        <!-- FILA para las dos gráficas: acelerómetro y giroscopio -->
        <div class="row g-4"> <!-- g-4 agrega separación entre columnas -->
            <!-- Tarjeta/columna para la gráfica del acelerómetro -->
            <div class="col-md-6"> <!-- Media pantalla en dispositivos md+ -->
                <div class="card shadow-sm"> <!-- Card de Bootstrap con sombra -->
                    <div class="card-body">
                        <h5 class="card-title">Acelerómetro (X, Y, Z)</h5> <!-- Título de la gráfica -->
                        <!-- Canvas donde se dibujará la gráfica del acelerómetro -->
                        <canvas id="acelerometroChart" width="400" height="250"></canvas>
                    </div>
                </div>
            </div>

            <!-- Tarjeta/columna para la gráfica del giroscopio -->
            <div class="col-md-6"> <!-- Media pantalla en dispositivos md+ -->
                <div class="card shadow-sm"> <!-- Card de Bootstrap con sombra -->
                    <div class="card-body">
                        <h5 class="card-title">Giroscopio (X, Y, Z)</h5> <!-- Título de la gráfica -->
                        <!-- Canvas donde se dibujará la gráfica del giroscopio -->
                        <canvas id="giroscopioChart" width="400" height="250"></canvas>
                    </div>
                </div>
            </div>
        </div> <!-- fin row de gráficas -->

        <!-- Pequeño pie explicativo (opcional) -->
        <div class="row mt-4">
            <div class="col-12 text-center text-muted">
                Selecciona un estado en el dropdown para actualizar las gráficas.
            </div>
        </div>

    </div> <!-- fin container -->

    <!-- Contenedor donde aparecerán las alertas flotantes -->
    <div id="alertContainer" class="position-fixed bottom-0 end-0 p-3" style="z-index: 1050;"></div>

    <!-- SCRIPTS al final del body para mejorar tiempos de carga -->

    <!-- Bootstrap JS Bundle (incluye Popper para dropdowns) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- (Opcional) Chart.js - la dejaremos lista para cuando implementemos las gráficas -->
    <!-- Puedes descomentar la siguiente línea en la etapa de Chart.js si quieres cargar la librería ahora -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>


    <!-- Script personalizado: captura la selección del dropdown y la muestra en consola -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const estadoBtn = document.getElementById('estadoDropdownBtn');
            const items = document.querySelectorAll('#estadoDropdownMenu .dropdown-item');
            const alertContainer = document.getElementById('alertContainer');

            // Función que crea un mensaje flotante (alerta Bootstrap)
            function mostrarAlerta(mensaje, tipo = 'info') {
                const alerta = document.createElement('div');
                alerta.className = `alert alert-${tipo} alert-dismissible fade show sombra-alerta`;
                alerta.role = 'alert';
                alerta.innerHTML = `
                    ${mensaje}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                `;
                alertContainer.appendChild(alerta);

                // Elimina la alerta automáticamente después de 3 segundos
                setTimeout(() => {
                    alerta.classList.remove('show');
                    alerta.classList.add('fade');
                    setTimeout(() => alerta.remove(), 300);
                }, 3000);
            }

            // Escucha los clics en los elementos del dropdown
            items.forEach(function (item) {
                item.addEventListener('click', function (event) {
                    event.preventDefault();
                    const estado = this.getAttribute('data-estado');
                    estadoBtn.textContent = this.textContent.trim();
                    estadoBtn.setAttribute('data-estado', estado);

                    console.log('Estado seleccionado:', estado);

                    // Muestra el mensaje flotante
                    mostrarAlerta(`Estado seleccionado: ${estado}`, 'primary');
                });
            });
        });
    </script>


    <!-- Fin del body y del documento -->
</body>

</html>